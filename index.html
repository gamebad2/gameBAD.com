<!DOCTYPE html>
<html lang="fa" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="دانلود بهترین بازی‌های موبایلی با GameBad - اخبار، بررسی‌ها و پشتیبانی کامل">
    <meta name="keywords" content="دانلود بازی موبایل, بازی‌های پرطرفدار, پابجی, کندی کراش, فری فایر">
    <title>GameBad - دانلود بازی‌های موبایلی پرطرفدار</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&family=Bungee&family=Noto+Sans:wght@400;700&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.1.6/dist/purify.min.js"></script>
    <style>
        :root {
            --bg-color: linear-gradient(135deg, #1a1a1a 0%, #0d47a1 100%);
            --header-bg: rgba(13, 110, 253, 0.8);
            --card-bg: rgba(44, 44, 44, 0.9);
            --text-color: #fff;
            --btn-bg: #198754;
            --btn-hover: #0d6efd;
            --card-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            --popup-bg: rgba(44, 44, 44, 0.9);
            --form-bg: rgba(44, 44, 44, 0.95);
        }

        [data-theme="light"] {
            --bg-color: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            --header-bg: rgba(255, 255, 255, 0.9);
            --card-bg: rgba(255, 255, 255, 0.95);
            --text-color: #333;
            --btn-bg: #28a745;
            --btn-hover: #007bff;
            --card-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            --popup-bg: rgba(255, 255, 255, 0.95);
            --form-bg: rgba(255, 255, 255, 0.95);
        }

        body {
            font-family: 'Vazirmatn', 'Noto Sans', sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            text-align: right;
            min-height: 100vh;
            background-attachment: fixed;
            transition: background 0.3s ease, color 0.3s ease;
        }

        header {
            background: var(--header-bg);
            padding: 20px;
            text-align: center;
            border-radius: 12px;
            margin-bottom: 20px;
            animation: fadeIn 1s ease-in-out;
            position: relative;
            box-shadow: var(--card-shadow);
            z-index: 1000;
        }

        .logo {
            font-family: 'Bungee', sans-serif;
            font-size: 48px;
            color: #0d6efd;
            text-shadow: 0 0 5px #0d6efd, 0 0 10px #0d6efd;
            animation: neonGlow 3s ease-in-out infinite;
        }

        .new-message-notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #dc3545;
            color: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            z-index: 9999;
            animation: fadeInOut 4s forwards;
            font-size: 1.1rem;
            text-align: center;
        }

        @keyframes fadeInOut {
            0% {
                opacity: 0;
                top: 0;
            }

            10% {
                opacity: 1;
                top: 20px;
            }

            90% {
                opacity: 1;
                top: 20px;
            }

            100% {
                opacity: 0;
                top: 0;
            }
        }

        .welcome-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 80vh;
            background: var(--form-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--card-shadow);
            animation: scaleUp 0.5s ease-in-out;
            text-align: center;
        }

        .welcome-section h2 {
            color: #0d6efd;
            margin-bottom: 20px;
            font-size: 28px;
        }

        .welcome-buttons {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .welcome-buttons button {
            background-color: var(--btn-bg);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }

        .welcome-buttons button:hover {
            background-color: var(--btn-hover);
        }

        .welcome-form {
            display: none;
            flex-direction: column;
            gap: 12px;
            width: 100%;
            max-width: 400px;
        }

        .welcome-form.active {
            display: flex;
        }

        .password-container {
            position: relative;
        }

        .password-container input {
            width: calc(100% - 30px);
        }

        .password-container .toggle-password {
            position: absolute;
            top: 50%;
            left: 10px;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-color);
            padding: 0;
        }

        .password-container .toggle-password svg {
            width: 20px;
            height: 20px;
            fill: var(--text-color);
        }

        .welcome-form input,
        .welcome-form select {
            padding: 10px;
            border-radius: 8px;
            border: none;
            background-color: rgba(44, 44, 44, 0.8);
            color: var(--text-color);
            font-size: 14px;
        }

        [data-theme="light"] .welcome-form input,
        [data-theme="light"] .welcome-form select {
            background-color: rgba(200, 200, 200, 0.8);
        }

        .welcome-form select {
            width: 100%;
        }

        .welcome-form p {
            font-size: 14px;
            color: #0d6efd;
        }

        .header-buttons {
            display: flex;
            gap: 10px;
            position: absolute;
            top: 20px;
            left: 20px;
        }

        .hamburger {
            background: none;
            border: none;
            color: var(--text-color);
            cursor: pointer;
            width: 40px;
            height: 40px;
            padding: 0;
            z-index: 1001;
        }

        .hamburger svg {
            width: 30px;
            height: 30px;
            fill: var(--text-color);
        }

        .hamburger.active svg {
            transform: rotate(90deg);
        }

        .nav-menu {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
        }

        .nav-menu button {
            background-color: var(--btn-bg);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .nav-menu button:hover {
            background-color: var(--btn-hover);
        }

        .nav-menu button.active {
            background-color: var(--btn-hover);
        }

        .nav-menu.active {
            display: flex;
            flex-direction: column;
            position: absolute;
            top: 70px;
            left: 0;
            background-color: var(--header-bg);
            width: 100%;
            padding: 20px;
            border-radius: 0 0 12px 12px;
            z-index: 1000;
            animation: slideDown 0.3s ease-in-out;
        }

        .notification-btn,
        .theme-toggle-btn,
        .user-menu-btn {
            background: none;
            border: none;
            color: var(--text-color);
            cursor: pointer;
            padding: 0;
            z-index: 1001;
        }

        .notification-btn svg,
        .theme-toggle-btn svg {
            width: 24px;
            height: 24px;
            fill: var(--text-color);
        }

        .user-menu-btn {
            font-size: 16px;
            font-family: 'Vazirmatn', sans-serif;
        }

        .notification-popup,
        .favorites-popup {
            display: none;
            position: fixed;
            top: 70px;
            left: 10px;
            background: var(--popup-bg);
            color: var(--text-color);
            border-radius: 12px;
            padding: 15px;
            max-width: 300px;
            z-index: 1001;
            animation: scaleUp 0.3s ease-in-out;
            box-shadow: var(--card-shadow);
        }

        .notification-popup.active,
        .favorites-popup.active {
            display: block;
        }

        .notification-item {
            padding: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        [data-theme="light"] .notification-item {
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .notification-item:last-child {
            border-bottom: none;
        }

        .user-menu {
            display: none;
            position: absolute;
            top: 50px;
            left: 10px;
            background: var(--popup-bg);
            border-radius: 8px;
            padding: 10px;
            z-index: 1001;
            animation: slideDown 0.3s ease-in-out;
            box-shadow: var(--card-shadow);
        }

        .user-menu.active {
            display: block;
        }

        .user-menu button {
            display: block;
            width: 100%;
            background: none;
            border: none;
            color: var(--text-color);
            padding: 8px;
            text-align: right;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .user-menu button:hover {
            background-color: var(--btn-hover);
            color: white;
            border-radius: 5px;
        }

        .admin-panel {
            display: none;
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            animation: fadeIn 1s ease-in-out;
            box-shadow: var(--card-shadow);
        }

        .admin-panel.active {
            display: block;
        }

        .admin-hamburger {
            background: none;
            border: none;
            color: var(--text-color);
            cursor: pointer;
            width: 40px;
            height: 40px;
            padding: 0;
            z-index: 1001;
            margin-bottom: 20px;
        }

        .admin-hamburger svg {
            width: 30px;
            height: 30px;
            fill: var(--text-color);
        }

        .admin-hamburger.active svg {
            transform: rotate(90deg);
        }

        .admin-nav-menu {
            display: none;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }

        .admin-nav-menu.active {
            display: flex;
        }

        .admin-nav-menu button {
            background-color: var(--btn-bg);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .admin-nav-menu button:hover {
            background-color: var(--btn-hover);
        }

        .admin-nav-menu button.active {
            background-color: var(--btn-hover);
        }

        .admin-content {
            display: none;
        }

        .admin-content.active {
            display: block;
        }

        .admin-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .admin-table th,
        .admin-table td {
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 10px;
            text-align: right;
        }

        [data-theme="light"] .admin-table th,
        [data-theme="light"] .admin-table td {
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .admin-table th {
            background-color: var(--btn-bg);
            color: white;
        }

        .admin-table button {
            background-color: #d81b60;
            color: white;
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            white-space: nowrap;
        }

        .admin-table button:hover {
            background-color: #b71c1c;
        }

        .admin-table button.unban {
            background-color: var(--btn-bg);
        }

        .admin-table button.unban:hover {
            background-color: var(--btn-hover);
        }

        .admin-table button.delete-user {
            background-color: #b71c1c;
        }

        .admin-table button.delete-user:hover {
            background-color: #7b1fa2;
        }

        #search {
            width: 100%;
            max-width: 600px;
            padding: 12px;
            margin: 10px auto;
            border-radius: 8px;
            border: none;
            font-size: 16px;
            background-color: rgba(44, 44, 44, 0.8);
            color: var(--text-color);
            display: block;
            transition: box-shadow 0.3s, background-color 0.3s;
        }

        [data-theme="light"] #search {
            background-color: rgba(200, 200, 200, 0.8);
        }

        #search:focus {
            box-shadow: 0 0 10px #0d6efd;
        }

        #search::placeholder {
            color: #aaa;
        }

        .filters,
        .favorite-filters {
            text-align: center;
            margin: 10px 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }

        .filter-btn,
        .favorite-filter-btn {
            background-color: var(--btn-bg);
            color: white;
            padding: 8px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .filter-btn:hover,
        .favorite-filter-btn:hover {
            background-color: var(--btn-hover);
        }

        .filter-btn.active,
        .favorite-filter-btn.active {
            background-color: var(--btn-hover);
        }

        .section-title {
            color: #0d6efd;
            margin: 20px 0;
            font-size: 24px;
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            padding: 0 10px;
        }

        .game-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 15px;
            box-shadow: var(--card-shadow);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            opacity: 0;
            transform: translateX(-50px);
            animation: slideInLeft 0.6s ease-in-out forwards;
            z-index: 1;
        }

        .game-card:nth-child(even) {
            transform: translateX(50px);
            animation: slideInRight 0.6s ease-in-out forwards;
        }

        .game-card:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(13, 110, 253, 0.6);
        }

        .game-logo {
            width: 100px;
            height: 100px;
            display: block;
            margin: 0 auto 10px;
            border-radius: 50%;
            object-fit: contain;
        }

        .game-card h3 {
            color: #0d6efd;
            margin-bottom: 10px;
            font-size: 18px;
            text-align: center;
        }

        .game-card p {
            margin: 5px 0;
            font-size: 14px;
        }

        .download-btn {
            background-color: var(--btn-bg);
            color: white;
            padding: 8px 15px;
            text-decoration: none;
            border-radius: 8px;
            display: block;
            text-align: center;
            margin-top: 10px;
            font-size: 14px;
            transition: background-color 0.5s ease;
        }

        .download-btn:hover {
            background-color: var(--btn-hover);
        }

        .favorite-btn {
            background-color: #ffca28;
            color: #1a1a1a;
            padding: 8px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            display: block;
            text-align: center;
            margin-top: 10px;
            font-size: 14px;
            transition: background-color 0.3s;
        }

        .favorite-btn:hover {
            background-color: #ffb300;
        }

        .favorite-btn.active {
            background-color: #d81b60;
            color: white;
        }

        .comment-btn {
            background-color: #0288d1;
            color: white;
            padding: 8px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            display: block;
            text-align: center;
            margin-top: 10px;
            font-size: 14px;
            transition: background-color 0.3s;
        }

        .comment-btn:hover {
            background-color: #0277bd;
        }

        .comment-form {
            display: none;
            flex-direction: column;
            gap: 12px;
            margin-top: 10px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }

        .comment-form input,
        .comment-form textarea {
            padding: 10px;
            border-radius: 8px;
            border: none;
            background-color: rgba(44, 44, 44, 0.8);
            color: var(--text-color);
        }

        [data-theme="light"] .comment-form input,
        [data-theme="light"] .comment-form textarea {
            background-color: rgba(200, 200, 200, 0.8);
        }

        .comment-form textarea {
            resize: vertical;
            min-height: 80px;
        }

        .comments-list {
            margin-top: 10px;
        }

        .comment-item {
            padding: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 14px;
        }

        [data-theme="light"] .comment-item {
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .comment-item:last-child {
            border-bottom: none;
        }

        .dashboard-content {
            display: none;
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            animation: fadeIn 1s ease-in-out;
            box-shadow: var(--card-shadow);
        }

        .dashboard-content.active {
            display: block;
        }

        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
        }

        .news-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 15px;
            transition: transform 0.3s ease;
            animation: slideInLeft 0.6s ease-in-out forwards;
        }

        .news-card:hover {
            transform: scale(1.03);
        }

        .support-form,
        .report-form {
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-width: 500px;
            margin: 0 auto;
        }

        .support-form input,
        .support-form textarea,
        .report-form input,
        .report-form textarea {
            padding: 10px;
            border-radius: 8px;
            border: none;
            background-color: rgba(44, 44, 44, 0.8);
            color: var(--text-color);
        }

        [data-theme="light"] .support-form input,
        [data-theme="light"] .support-form textarea,
        [data-theme="light"] .report-form input,
        [data-theme="light"] .report-form textarea {
            background-color: rgba(200, 200, 200, 0.8);
        }

        .support-form textarea,
        .report-form textarea {
            resize: vertical;
            min-height: 100px;
        }

        .submit-btn {
            background-color: var(--btn-bg);
            color: white;
            padding: 10px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .submit-btn:hover {
            background-color: var(--btn-hover);
        }

        .about-section {
            text-align: center;
            max-width: 600px;
            margin: 0 auto;
        }

        footer {
            text-align: center;
            margin-top: 40px;
            color: #aaa;
            font-size: 14px;
        }

        [data-theme="light"] footer {
            color: #555;
        }

        .site-info {
            text-align: center;
            margin-top: 20px;
            line-height: 1.5;
            color: #ddd;
        }

        [data-theme="light"] .site-info {
            color: #555;
        }

        .chat-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-width: 700px;
            margin: 0 auto;
        }

        .chat-container h3 {
            color: #0d6efd;
            margin: 0;
            font-size: 20px;
        }

        .chat-list {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 15px;
            min-height: 200px;
            max-height: 400px;
            overflow-y: auto;
        }

        .chat-message {
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .chat-message.sent {
            background-color: #0d6efd;
            text-align: right;
        }

        .chat-message.received {
            background-color: #198754;
            text-align: left;
        }

        .chat-message.received:hover {
            background-color: #146e3b;
        }


        .chat-message strong {
            display: block;
            margin-bottom: 5px;
        }

        .new-message-form {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .new-message-form input,
        .new-message-form textarea {
            padding: 10px;
            border-radius: 8px;
            border: none;
            background-color: rgba(44, 44, 44, 0.8);
            color: var(--text-color);
        }

        [data-theme="light"] .new-message-form input,
        [data-theme="light"] .new-message-form textarea {
            background-color: rgba(200, 200, 200, 0.8);
        }

        .new-message-form textarea {
            resize: vertical;
            min-height: 80px;
        }


        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-50px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(50px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes scaleUp {
            from {
                opacity: 0;
                transform: scale(0.9);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes neonGlow {
            0% {
                text-shadow: 0 0 5px #0d6efd, 0 0 10px #0d6efd;
            }

            50% {
                text-shadow: 0 0 10px #0d6efd, 0 0 15px #0d6efd;
            }

            100% {
                text-shadow: 0 0 5px #0d6efd, 0 0 10px #0d6efd;
            }
        }

        .game-card:nth-child(1) {
            animation-delay: 0.1s;
        }

        .game-card:nth-child(2) {
            animation-delay: 0.2s;
        }

        .game-card:nth-child(3) {
            animation-delay: 0.3s;
        }

        .game-card:nth-child(4) {
            animation-delay: 0.4s;
        }

        .game-card:nth-child(5) {
            animation-delay: 0.5s;
        }

        @media (max-width: 600px) {

            .games-grid,
            .news-grid {
                grid-template-columns: 1fr;
            }

            .game-card,
            .news-card {
                padding: 12px;
            }

            .game-card h3,
            .news-card h3 {
                font-size: 16px;
            }

            .game-card p,
            .news-card p {
                font-size: 12px;
            }

            .download-btn,
            .submit-btn,
            .favorite-btn,
            .comment-btn {
                font-size: 12px;
                padding: 6px 12px;
            }

            header {
                padding: 15px;
            }

            .logo {
                font-size: 36px;
            }

            .game-logo {
                width: 80px;
                height: 80px;
            }

            .header-buttons {
                display: flex;
            }

            .nav-menu {
                display: none;
            }

            .nav-menu.active {
                display: flex;
            }

            .user-menu {
                width: 150px;
            }

            .welcome-section {
                padding: 15px;
            }

            .welcome-form {
                max-width: 100%;
            }
        }

        @media (min-width: 601px) and (max-width: 900px) {
            .games-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .news-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>

<body>
    <section class="welcome-section" id="welcome">
        <h1 class="logo">GameBad</h1>
        <p>بهترین مرجع دانلود بازی‌های موبایل</p>
        <div class="welcome-buttons">
            <button onclick="showLoginForm()">ورود</button>
            <button onclick="showRegisterForm()">ثبت‌نام</button>
        </div>
        <div class="welcome-form" id="login-form">
            <input type="text" id="login-username" placeholder="یوزرنیم">
            <div class="password-container">
                <input type="password" id="login-password" placeholder="رمز عبور">
                <button type="button" class="toggle-password" onclick="togglePasswordVisibility('login-password')">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M12 4.5C7 4.5 2.73 7.61 0 12c2.73 4.39 7 7.5 12 7.5s9.27-3.11 12-7.5c-2.73-4.39-7-7.5-12-7.5zM12 17.5c-4.41 0-8.24-2.82-10-6.5C3.76 8.32 7.59 5.5 12 5.5s8.24 2.82 10 6.5c-1.76 3.68-5.59 6.5-10 6.5z" />
                        <circle cx="12" cy="12" r="3" />
                    </svg>
                </button>
            </div>
            <button class="submit-btn" onclick="login()">ورود</button>
        </div>
        <div class="welcome-form" id="register-form">
            <input type="text" id="register-username" placeholder="یوزرنیم (فقط حروف انگلیسی و اعداد)">
            <input type="text" id="register-first-name" placeholder="نام">
            <input type="text" id="register-last-name" placeholder="نام خانوادگی">
            <div class="password-container">
                <input type="password" id="register-password" placeholder="رمز عبور (حداقل ۸ کاراکتر)">
                <button type="button" class="toggle-password" onclick="togglePasswordVisibility('register-password')">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M12 4.5C7 4.5 2.73 7.61 0 12c2.73 4.39 7 7.5 12 7.5s9.27-3.11 12-7.5c-2.73-4.39-7-7.5-12-7.5zM12 17.5c-4.41 0-8.24-2.82-10-6.5C3.76 8.32 7.59 5.5 12 5.5s8.24 2.82 10 6.5c-1.76 3.68-5.59 6.5-10 6.5z" />
                        <circle cx="12" cy="12" r="3" />
                    </svg>
                </button>
            </div>
            <p id="username-status"></p>
            <select id="favorite-game-1">
                <option value="">بازی مورد علاقه ۱</option>
            </select>
            <select id="favorite-game-2">
                <option value="">بازی مورد علاقه ۲</option>
            </select>
            <select id="favorite-game-3">
                <option value="">بازی مورد علاقه ۳</option>
            </select>
            <button class="submit-btn" onclick="register()">ثبت‌نام</button>
        </div>
        <div class="site-info">
            <p>این سایت توسط <strong>امیرحسین</strong> برای ارائه بهترین بازی‌ها به شما ساخته شده است.</p>
        </div>
    </section>

    <header id="main-header" style="display: none;">
        <h1 class="logo">GameBad</h1>
        <p>بهترین مرجع دانلود بازی‌های موبایلی - توسط امیرحسین</p>
        <div class="header-buttons">
            <button class="hamburger" aria-label="منو اصلی">
                <svg viewBox="0 0 24 24">
                    <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
                </svg>
            </button>
            <button class="notification-btn" aria-label="اعلانات">
                <svg viewBox="0 0 24 24">
                    <path
                        d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.1-1.6-5.8-4-6.8V4h-4v2.2C7.6 7.2 6 9.9 6 13v5l-2 2v1h16v-1l-2-2z" />
                </svg>
            </button>
            <button class="theme-toggle-btn" aria-label="تغییر تم">
                <svg viewBox="0 0 24 24">
                    <path
                        d="M12 3a9 9 0 1 0 9 9c0-.5-.1-1-.1-1.5-.4.2-.9.3-1.4.3-2.5 0-4.5-2-4.5-4.5 0-.5.1-1 .3-1.4-.5 0-1-.1-1.5-.1A9 9 0 0 0 12 3z" />
                </svg>
            </button>
            <button class="user-menu-btn" aria-label="منوی کاربر"></button>
        </div>
        <div class="notification-popup">
            <div class="notification-item">بازی جدید: اسفالت ۱۰ معرفی شد! - ۱۵ آبان ۱۴۰۴</div>
            <div class="notification-item">آپدیت پابجی: نقشه جدید اضافه شد - ۱۰ آبان ۱۴۰۴</div>
            <div class="notification-item">رویداد ویژه کندی کراش شروع شد - ۵ آبان ۱۴۰۴</div>
        </div>
        <div class="favorites-popup">
            <div class="favorites-list" id="favorites-list"></div>
            <button class="submit-btn" onclick="closeFavoritesPopup()">بستن</button>
        </div>
        <div class="user-menu">
            <button onclick="showEditProfile()">ویرایش پروفایل</button>
            <button onclick="showFavoriteGames()">دیدن بازی‌های مورد علاقه</button>
            <button onclick="logout()">خروج</button>
        </div>
        <div class="nav-menu">
            <button class="dashboard-btn active" data-section="home">خانه</button>
            <button class="dashboard-btn" data-section="news">اخبار</button>
            <button class="dashboard-btn" data-section="favorites">علاقه‌مندی‌ها</button>
            <button class="dashboard-btn" data-section="messages">پیام‌ها</button>
            <button class="dashboard-btn" data-section="support">پشتیبانی</button>
            <button class="dashboard-btn" data-section="report">گزارش خطا</button>
            <button class="dashboard-btn" data-section="about">درباره ما</button>
            <button class="dashboard-btn" data-section="admin" style="display: none;">پنل ادمین</button>
        </div>
    </header>

    <input type="text" id="search" placeholder="جستجوی بازی (مثل پابجی یا کندی)..." style="display: none;">

    <div class="filters" style="display: none;">
        <button class="filter-btn active" data-filter="all">همه</button>
        <button class="filter-btn" data-filter="آنلاین">آنلاین</button>
        <button class="filter-btn" data-filter="آفلاین">آفلاین</button>
        <button class="filter-btn" data-genre="بتل رویال">بتل رویال</button>
        <button class="filter-btn" data-genre="پازل">پازل</button>
        <button class="filter-btn" data-genre="اکشن">اکشن</button>
        <button class="filter-btn" data-rating="+3">۳+</button>
        <button class="filter-btn" data-rating="+7">۷+</button>
        <button class="filter-btn" data-rating="+12">۱۲+</button>
    </div>

    <section class="dashboard-content" id="home" style="display: none;">
        <section id="top-games">
            <h2 class="section-title">۵ بازی پرطرفدار</h2>
            <div class="games-grid" id="top-grid"></div>
        </section>
        <section id="suggested-games">
            <h2 class="section-title">بازی‌های پیشنهادی</h2>
            <div class="games-grid" id="suggested-grid"></div>
        </section>
    </section>

    <section class="dashboard-content" id="news" style="display: none;">
        <h2 class="section-title">اخبار دنیای گیم</h2>
        <div class="news-grid" id="news-grid"></div>
    </section>

    <section class="dashboard-content" id="favorites" style="display: none;">
        <h2 class="section-title">علاقه‌مندی‌ها</h2>
        <div class="favorite-filters">
            <button class="favorite-filter-btn active" data-filter="all">همه</button>
            <button class="favorite-filter-btn" data-filter="آنلاین">آنلاین</button>
            <button class="favorite-filter-btn" data-filter="آفلاین">آفلاین</button>
            <button class="favorite-filter-btn" data-genre="بتل رویال">بتل رویال</button>
            <button class="favorite-filter-btn" data-genre="پازل">پازل</button>
            <button class="favorite-filter-btn" data-genre="اکشن">اکشن</button>
            <button class="favorite-filter-btn" data-rating="+3">۳+</button>
            <button class="favorite-filter-btn" data-rating="+7">۷+</button>
            <button class="favorite-filter-btn" data-rating="+12">۱۲+</button>
        </div>
        <div class="games-grid" id="favorites-grid"></div>
    </section>

    <section class="dashboard-content" id="messages" style="display: none;">
        <h2 class="section-title">پیام‌ها</h2>
        <button class="submit-btn" onclick="showSendMessageForm()">ارسال پیام جدید</button>
        <div class="chat-container">
            <h3>اینباکس (پیام‌های دریافتی)</h3>
            <div class="chat-list" id="inbox-list"></div>
            <h3>صندوق خروجی (پیام‌های ارسالی)</h3>
            <div class="chat-list" id="outbox-list"></div>
        </div>
        <div class="new-message-form" style="display: none;">
            <h3>پیام جدید</h3>
            <input type="text" id="message-recipient" placeholder="یوزرنیم گیرنده">
            <textarea id="message-text" placeholder="متن پیام"></textarea>
            <button class="submit-btn" onclick="sendMessage()">ارسال پیام</button>
        </div>
    </section>

    <section class="dashboard-content" id="edit-profile" style="display: none;">
        <h2 class="section-title">ویرایش پروفایل</h2>
        <div class="support-form">
            <p><strong>یوزرنیم شما:</strong> <span id="profile-username"></span></p>
            <input type="text" id="edit-first-name" placeholder="نام جدید">
            <input type="text" id="edit-last-name" placeholder="نام خانوادگی جدید">
            <div class="password-container">
                <input type="password" id="edit-password" placeholder="رمز عبور جدید (حداقل ۸ کاراکتر)">
                <button type="button" class="toggle-password" onclick="togglePasswordVisibility('edit-password')">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M12 4.5C7 4.5 2.73 7.61 0 12c2.73 4.39 7 7.5 12 7.5s9.27-3.11 12-7.5c-2.73-4.39-7-7.5-12-7.5zM12 17.5c-4.41 0-8.24-2.82-10-6.5C3.76 8.32 7.59 5.5 12 5.5s8.24 2.82 10 6.5c-1.76 3.68-5.59 6.5-10 6.5z" />
                        <circle cx="12" cy="12" r="3" />
                    </svg>
                </button>
            </div>
            <button class="submit-btn" onclick="saveProfileChanges()">ذخیره تغییرات</button>
        </div>
    </section>

    <section class="dashboard-content" id="support" style="display: none;">
        <h2 class="section-title">پشتیبانی</h2>
        <div class="support-form">
            <input type="text" id="support-name" placeholder="نام شما">
            <textarea id="support-message" placeholder="نظر یا پیشنهاد شما"></textarea>
            <button class="submit-btn" onclick="submitSupport()">ارسال</button>
        </div>
    </section>

    <section class="dashboard-content" id="report" style="display: none;">
        <h2 class="section-title">گزارش خطا</h2>
        <div class="report-form">
            <input type="text" id="report-name" placeholder="نام شما">
            <textarea id="report-message" placeholder="توضیح خطا یا مشکل"></textarea>
            <button class="submit-btn" onclick="submitReport()">ارسال</button>
        </div>
    </section>

    <section class="dashboard-content" id="about" style="display: none;">
        <h2 class="section-title">درباره ما</h2>
        <div class="about-section">
            <p>سایت GameBad توسط <strong>امیرحسین</strong>، یه عاشق گیم و تکنولوژی، ساخته شده! ازش تشکر می‌کنیم که این
                فضای جذاب رو برای گیمرها فراهم کرده! 😎</p>
        </div>
    </section>

    <section class="admin-panel" id="admin" style="display: none;">
        <h2 class="section-title">پنل ادمین</h2>
        <button class="admin-hamburger" aria-label="منو ادمین">
            <svg viewBox="0 0 24 24">
                <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
            </svg>
        </button>
        <div class="admin-nav-menu">
            <button class="admin-btn active" data-section="admin-users">کاربران</button>
            <button class="admin-btn" data-section="admin-comments">نظرات</button>
            <button class="admin-btn" data-section="admin-reports">گزارش‌ها</button>
            <button class="admin-btn" data-section="admin-supports">پشتیبانی</button>
            <button class="admin-btn" onclick="logout()">خروج</button>
        </div>
        <div class="admin-content active" id="admin-users">
            <h3>کاربران</h3>
            <table class="admin-table" id="users-table">
                <thead>
                    <tr>
                        <th>یوزرنیم</th>
                        <th>نام</th>
                        <th>نام خانوادگی</th>
                        <th>تاریخ ثبت‌نام</th>
                        <th>آخرین ورود</th>
                        <th>وضعیت</th>
                        <th>عملیات</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        <div class="admin-content" id="admin-comments">
            <h3>نظرات</h3>
            <table class="admin-table" id="comments-table">
                <thead>
                    <tr>
                        <th>بازی</th>
                        <th>کاربر</th>
                        <th>نظر</th>
                        <th>عملیات</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        <div class="admin-content" id="admin-reports">
            <h3>گزارش‌های خطا</h3>
            <table class="admin-table" id="reports-table">
                <thead>
                    <tr>
                        <th>نام</th>
                        <th>مشکل</th>
                        <th>عملیات</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        <div class="admin-content" id="admin-supports">
            <h3>درخواست‌های پشتیبانی</h3>
            <table class="admin-table" id="supports-table">
                <thead>
                    <tr>
                        <th>نام</th>
                        <th>پیام</th>
                        <th>عملیات</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </section>

    <footer>
        <p>&copy; 1404 GameBad. تمامی حقوق محفوظ است.</p>
    </footer>

    <script>
        // Data
        const GAMES = [{
            id: 'pubg',
            name: 'پابجی موبایل',
            type: 'آنلاین',
            genre: 'بتل رویال',
            rating: '+12',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/pubg_logo_icon_143091.png',
            downloads: '۲.۵ میلیون',
            rating: '۴.۷'
        },
        {
            id: 'candy-crush',
            name: 'کندی کراش',
            type: 'آفلاین',
            genre: 'پازل',
            rating: '+3',
            warnings: '',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/candy_crush_logo_icon_143093.png',
            downloads: '۱.۸ میلیون',
            rating: '۴.۵'
        },
        {
            id: 'free-fire',
            name: 'فری فایر',
            type: 'آنلاین',
            genre: 'بتل رویال',
            rating: '+12',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/free_fire_logo_icon_143094.png',
            downloads: '۲.۱ میلیون',
            rating: '۴.۶'
        },
        {
            id: 'asphalt-9',
            name: 'آسفالت ۹',
            type: 'آنلاین',
            genre: 'مسابقه‌ای',
            rating: '+7',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/asphalt_9_logo_icon_143088.png',
            downloads: '۱.۲ میلیون',
            rating: '۴.۸'
        },
        {
            id: 'clash-of-clans',
            name: 'کلش آو کلنز',
            type: 'آنلاین',
            genre: 'استراتژی',
            rating: '+7',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/clash_of_clans_logo_icon_143092.png',
            downloads: '۳.۵ میلیون',
            rating: '۴.۹'
        },
        {
            id: 'call-of-duty',
            name: 'کالاف دیوتی موبایل',
            type: 'آنلاین',
            genre: 'اکشن',
            rating: '+12',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/call_of_duty_logo_icon_143090.png',
            downloads: '۳.۰ میلیون',
            rating: '۴.۷'
        },
        {
            id: 'subway-surfers',
            name: 'ساب‌وی سرفرز',
            type: 'آفلاین',
            genre: 'دوندگی',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/subway_surfers_logo_icon_143098.png',
            downloads: '۱.۹ میلیون',
            rating: '۴.۶'
        },
        {
            id: 'angry-birds',
            name: 'انگری بردز',
            type: 'آفلاین',
            genre: 'پازل',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/angry_birds_logo_icon_143087.png',
            downloads: '۱.۰ میلیون',
            rating: '۴.۴'
        },
        {
            id: 'gta-v',
            name: 'جی‌تی‌ای وی',
            type: 'آفلاین',
            genre: 'اکشن',
            rating: '+18',
            warnings: 'خشونت و محتوای بزرگسال',
            logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/c/c9/Grand_Theft_Auto_V_logo.svg/512px-Grand_Theft_Auto_V_logo.svg.png',
            downloads: '۵.۲ میلیون',
            rating: '۴.۹'
        },
        {
            id: 'minecraft',
            name: 'ماینکرفت',
            type: 'آنلاین',
            genre: 'ماجراجویی',
            rating: '+7',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://upload.wikimedia.org/wikipedia/fa/8/82/Minecraft_logo.png',
            downloads: '۶.۵ میلیون',
            rating: '۴.۸'
        },
        {
            id: 'fortnite',
            name: 'فورتنایت',
            type: 'آنلاین',
            genre: 'بتل رویال',
            rating: '+12',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/fortnite_logo_icon_143099.png',
            downloads: '۴.۰ میلیون',
            rating: '۴.۷'
        },
        {
            id: 'roblox',
            name: 'روبلاکس',
            type: 'آنلاین',
            genre: 'ماجراجویی',
            rating: '+7',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/roblox_logo_icon_143095.png',
            downloads: '۴.۳ میلیون',
            rating: '۴.۶'
        },
        {
            id: 'genshin-impact',
            name: 'گنشین ایمپکت',
            type: 'آنلاین',
            genre: 'نقش‌آفرینی',
            rating: '+12',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/genshin_impact_logo_icon_143096.png',
            downloads: '۳.۱ میلیون',
            rating: '۴.۹'
        },
        {
            id: 'brawl-stars',
            name: 'براول استارز',
            type: 'آنلاین',
            genre: 'اکشن',
            rating: '+7',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/brawl_stars_logo_icon_143089.png',
            downloads: '۲.۸ میلیون',
            rating: '۴.۵'
        },
        {
            id: 'clash-royale',
            name: 'کلش رویال',
            type: 'آنلاین',
            genre: 'استراتژی',
            rating: '+7',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/clash_royale_logo_icon_143097.png',
            downloads: '۲.۹ میلیون',
            rating: '۴.۶'
        },
        {
            id: 'league-of-legends-wild-rift',
            name: 'لیگ آف لجندز',
            type: 'آنلاین',
            genre: 'استراتژی',
            rating: '+12',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/league_of_legends_logo_icon_143100.png',
            downloads: '۲.۵ میلیون',
            rating: '۴.۷'
        },
        {
            id: 'hay-day',
            name: 'هی دی',
            type: 'آنلاین',
            genre: 'استراتژی',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/hay_day_logo_icon_143101.png',
            downloads: '۱.۵ میلیون',
            rating: '۴.۴'
        },
        {
            id: 'pokemon-go',
            name: 'پوکمون گو',
            type: 'آنلاین',
            genre: 'ماجراجویی',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/pokemon_go_logo_icon_143102.png',
            downloads: '۱.۷ میلیون',
            rating: '۴.۳'
        },
        {
            id: 'plants-vs-zombies',
            name: 'گیاهان در برابر زامبی‌ها',
            type: 'آفلاین',
            genre: 'استراتژی',
            rating: '+7',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/plants_vs_zombies_logo_icon_143103.png',
            downloads: '۲.۰ میلیون',
            rating: '۴.۸'
        },
        {
            id: 'temple-run',
            name: 'تمپل ران',
            type: 'آفلاین',
            genre: 'دوندگی',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/temple_run_logo_icon_143104.png',
            downloads: '۱.۶ میلیون',
            rating: '۴.۲'
        },
        {
            id: 'candy-crush-soda-saga',
            name: 'کندی کراش سودا ساگا',
            type: 'آفلاین',
            genre: 'پازل',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/candy_crush_soda_saga_logo_icon_143105.png',
            downloads: '۱.۳ میلیون',
            rating: '۴.۴'
        },
        {
            id: 'subway-surfers-2',
            name: 'ساب‌وی سرفرز ۲',
            type: 'آفلاین',
            genre: 'دوندگی',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/subway_surfers_logo_icon_143098.png',
            downloads: '۱.۴ میلیون',
            rating: '۴.۵'
        },
        {
            id: 'pvz-2',
            name: 'گیاهان در برابر زامبی‌ها ۲',
            type: 'آفلاین',
            genre: 'استراتژی',
            rating: '+7',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/plants_vs_zombies_logo_icon_143103.png',
            downloads: '۲.۲ میلیون',
            rating: '۴.۹'
        },
        {
            id: 'shadow-fight-2',
            name: 'شدو فایت ۲',
            type: 'آفلاین',
            genre: 'اکشن',
            rating: '+12',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/shadow_fight_2_logo_icon_143106.png',
            downloads: '۱.۸ میلیون',
            rating: '۴.۶'
        },
        {
            id: 'dream-league-soccer',
            name: 'دریم لیگ ساکر',
            type: 'آفلاین',
            genre: 'ورزشی',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/dream_league_soccer_logo_icon_143107.png',
            downloads: '۲.۱ میلیون',
            rating: '۴.۷'
        },
        {
            id: 'minion-rush',
            name: 'مینیون راش',
            type: 'آفلاین',
            genre: 'دوندگی',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/minion_rush_logo_icon_143108.png',
            downloads: '۱.۵ میلیون',
            rating: '۴.۳'
        },
        {
            id: 'pou',
            name: 'پو',
            type: 'آفلاین',
            genre: 'پازل',
            rating: '+3',
            warnings: '',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/pou_logo_icon_143109.png',
            downloads: '۳.۴ میلیون',
            rating: '۴.۵'
        },
        {
            id: 'sonic-dash',
            name: 'سونیک دش',
            type: 'آفلاین',
            genre: 'دوندگی',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/sonic_dash_logo_icon_143110.png',
            downloads: '۱.۹ میلیون',
            rating: '۴.۶'
        },
        {
            id: 'talking-tom',
            name: 'تام سخنگو',
            type: 'آفلاین',
            genre: 'پازل',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/talking_tom_logo_icon_143111.png',
            downloads: '۲.۶ میلیون',
            rating: '۴.۴'
        },
        {
            id: 'real-racing-3',
            name: 'ریال ریسینگ ۳',
            type: 'آنلاین',
            genre: 'مسابقه‌ای',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/real_racing_3_logo_icon_143112.png',
            downloads: '۱.۳ میلیون',
            rating: '۴.۷'
        },
        {
            id: 'hill-climb-racing',
            name: 'هیل کلایمب ریسینگ',
            type: 'آفلاین',
            genre: 'مسابقه‌ای',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/hill_climb_racing_logo_icon_143113.png',
            downloads: '۱.۷ میلیون',
            rating: '۴.۶'
        },
        {
            id: 'bad-piggies',
            name: 'بد پیگیز',
            type: 'آفلاین',
            genre: 'پازل',
            rating: '+3',
            warnings: '',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/bad_piggies_logo_icon_143114.png',
            downloads: '۱.۰ میلیون',
            rating: '۴.۳'
        },
        {
            id: 'cut-the-rope',
            name: 'کات د روپ',
            type: 'آفلاین',
            genre: 'پازل',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/cut_the_rope_logo_icon_143115.png',
            downloads: '۱.۱ میلیون',
            rating: '۴.۴'
        },
        {
            id: 'fruit-ninja',
            name: 'فروت نینجا',
            type: 'آفلاین',
            genre: 'اکشن',
            rating: '+7',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/fruit_ninja_logo_icon_143116.png',
            downloads: '۱.۵ میلیون',
            rating: '۴.۵'
        },
        {
            id: 'jetpack-joyride',
            name: 'جت‌پک جوی‌راید',
            type: 'آفلاین',
            genre: 'دوندگی',
            rating: '+7',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/jetpack_joyride_logo_icon_143117.png',
            downloads: '۱.۸ میلیون',
            rating: '۴.۶'
        },
        {
            id: 'limbo',
            name: 'لیمبو',
            type: 'آفلاین',
            genre: 'ماجراجویی',
            rating: '+12',
            warnings: 'محتوای ترسناک',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/limbo_logo_icon_143118.png',
            downloads: '۰.۹ میلیون',
            rating: '۴.۹'
        },
        {
            id: 'stardew-valley',
            name: 'استاردو ولی',
            type: 'آفلاین',
            genre: 'شبیه‌سازی',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/stardew_valley_logo_icon_143119.png',
            downloads: '۱.۴ میلیون',
            rating: '۴.۸'
        },
        {
            id: 'terraria',
            name: 'تراریا',
            type: 'آفلاین',
            genre: 'ماجراجویی',
            rating: '+12',
            warnings: 'خشونت فانتزی',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/terraria_logo_icon_143120.png',
            downloads: '۱.۲ میلیون',
            rating: '۴.۷'
        },
        {
            id: 'among-us',
            name: 'آمِانگ آس',
            type: 'آنلاین',
            genre: 'پازل',
            rating: '+7',
            warnings: '',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/among_us_logo_icon_143121.png',
            downloads: '۲.۳ میلیون',
            rating: '۴.۴'
        },
        {
            id: 'super-mario-run',
            name: 'سوپر ماریو ران',
            type: 'آفلاین',
            genre: 'دوندگی',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/super_mario_run_logo_icon_143122.png',
            downloads: '۱.۵ میلیون',
            rating: '۴.۱'
        },
        {
            id: 'hill-climb-racing-2',
            name: 'هیل کلایمب ریسینگ ۲',
            type: 'آنلاین',
            genre: 'مسابقه‌ای',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/hill_climb_racing_logo_icon_143113.png',
            downloads: '۱.۸ میلیون',
            rating: '۴.۷'
        },
        {
            id: 'subway-surfers-world-tour',
            name: 'ساب‌وی سرفرز تور جهانی',
            type: 'آفلاین',
            genre: 'دوندگی',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/subway_surfers_logo_icon_143098.png',
            downloads: '۲.۱ میلیون',
            rating: '۴.۶'
        },
        {
            id: 'temple-run-2',
            name: 'تمپل ران ۲',
            type: 'آفلاین',
            genre: 'دوندگی',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/temple_run_logo_icon_143104.png',
            downloads: '۱.۹ میلیون',
            rating: '۴.۵'
        },
        {
            id: 'shadow-fight-3',
            name: 'شدو فایت ۳',
            type: 'آنلاین',
            genre: 'اکشن',
            rating: '+12',
            warnings: 'خشونت فانتزی',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/shadow_fight_3_logo_icon_143123.png',
            downloads: '۱.۵ میلیون',
            rating: '۴.۸'
        },
        {
            id: 'mortal-kombat',
            name: 'مورتال کامبت',
            type: 'آنلاین',
            genre: 'اکشن',
            rating: '+18',
            warnings: 'خشونت شدید',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/mortal_kombat_logo_icon_143124.png',
            downloads: '۱.۴ میلیون',
            rating: '۴.۷'
        },
        {
            id: 'injustice-2',
            name: 'اینجاستیس ۲',
            type: 'آنلاین',
            genre: 'اکشن',
            rating: '+12',
            warnings: 'خشونت فانتزی',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/injustice_2_logo_icon_143125.png',
            downloads: '۱.۳ میلیون',
            rating: '۴.۶'
        },
        {
            id: 'need-for-speed-no-limits',
            name: 'نید فور اسپید: نو لیمیتز',
            type: 'آنلاین',
            genre: 'مسابقه‌ای',
            rating: '+7',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/need_for_speed_no_limits_logo_icon_143126.png',
            downloads: '۱.۶ میلیون',
            rating: '۴.۵'
        },
        {
            id: 'mario-kart-tour',
            name: 'ماریو کارت تور',
            type: 'آنلاین',
            genre: 'مسابقه‌ای',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/mario_kart_tour_logo_icon_143127.png',
            downloads: '۱.۲ میلیون',
            rating: '۴.۳'
        },
        {
            id: 'dragon-ball-legends',
            name: 'دراگون بال لجندز',
            type: 'آنلاین',
            genre: 'نقش‌آفرینی',
            rating: '+12',
            warnings: 'خشونت فانتزی',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/dragon_ball_legends_logo_icon_143128.png',
            downloads: '۱.۱ میلیون',
            rating: '۴.۵'
        },
        {
            id: 'marvel-future-fight',
            name: 'مارول فیوچر فایت',
            type: 'آنلاین',
            genre: 'اکشن',
            rating: '+12',
            warnings: 'خشونت فانتزی',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/marvel_future_fight_logo_icon_143129.png',
            downloads: '۱.۰ میلیون',
            rating: '۴.۴'
        },
        {
            id: 'candy-crush-jelly-saga',
            name: 'کندی کراش جلی ساگا',
            type: 'آفلاین',
            genre: 'پازل',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/candy_crush_jelly_saga_logo_icon_143130.png',
            downloads: '۰.۹ میلیون',
            rating: '۴.۲'
        },
        {
            id: 'simcity-buildit',
            name: 'سیم‌سیتی بیلدیت',
            type: 'آنلاین',
            genre: 'شبیه‌سازی',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/simcity_buildit_logo_icon_143131.png',
            downloads: '۱.۴ میلیون',
            rating: '۴.۵'
        },
        {
            id: 'the-sims-mobile',
            name: 'سیمز موبایل',
            type: 'آنلاین',
            genre: 'شبیه‌سازی',
            rating: '+7',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/the_sims_mobile_logo_icon_143132.png',
            downloads: '۱.۱ میلیون',
            rating: '۴.۳'
        },
        {
            id: 'pokemon-unite',
            name: 'پوکمون یونایت',
            type: 'آنلاین',
            genre: 'اکشن',
            rating: '+7',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/pokemon_unite_logo_icon_143133.png',
            downloads: '۰.۸ میلیون',
            rating: '۴.۱'
        },
        {
            id: 'fifa-mobile',
            name: 'فیفا موبایل',
            type: 'آنلاین',
            genre: 'ورزشی',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/fifa_mobile_logo_icon_143134.png',
            downloads: '۲.۶ میلیون',
            rating: '۴.۴'
        },
        {
            id: 'pes-mobile',
            name: 'پس موبایل',
            type: 'آنلاین',
            genre: 'ورزشی',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/pes_mobile_logo_icon_143135.png',
            downloads: '۲.۲ میلیون',
            rating: '۴.۵'
        },
        {
            id: '8-ball-pool',
            name: 'ایت بال پول',
            type: 'آنلاین',
            genre: 'ورزشی',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/8_ball_pool_logo_icon_143136.png',
            downloads: '۱.۷ میلیون',
            rating: '۴.۳'
        },
        {
            id: 'ludo-king',
            name: 'لودو کینگ',
            type: 'آنلاین',
            genre: 'پازل',
            rating: '+3',
            warnings: 'خرید درون‌برنامه‌ای',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/ludo_king_logo_icon_143137.png',
            downloads: '۲.۴ میلیون',
            rating: '۴.۶'
        },
        {
            id: 'slither-io',
            name: 'اسلیتر دات آی‌او',
            type: 'آنلاین',
            genre: 'اکشن',
            rating: '+3',
            warnings: '',
            logo: 'https://cdn.icon-icons.com/icons2/2360/PNG/512/slither_io_logo_icon_143138.png',
            downloads: '۱.۳ میلیون',
            rating: '۴.۲'
        }
        ];

        const NEWS = [{
            title: 'بروزرسانی جدید پابجی موبایل',
            date: '۱ آبان ۱۴۰۴',
            content: 'نسخه جدید با نقشه‌های جدید و آیتم‌های جذاب منتشر شد!'
        },
        {
            title: 'فری فایر: رویداد هالووین',
            date: '۳۰ مهر ۱۴۰۴',
            content: 'رویداد ویژه هالووین با جوایز محدود شروع شد.'
        },
        {
            title: 'رونمایی از بازی جدید استودیو Supercell',
            date: '۱۵ مهر ۱۴۰۴',
            content: 'بازی جدید در سبک استراتژی معرفی شد.'
        },
        {
            title: 'ورژن موبایل GTA V تایید شد',
            date: '۱۴ مهر ۱۴۰۴',
            content: 'استودیو راکستار رسماً اعلام کرد که در حال ساخت نسخه موبایل GTA V است.'
        },
        {
            title: 'آپدیت بزرگ ماینکرفت با ویژگی‌های جدید',
            date: '۱۸ مهر ۱۴۰۴',
            content: 'ماینکرفت آپدیت جدیدی با بلوک‌ها و موجودات تازه منتشر کرد.'
        },
        {
            title: 'تورنمنت بزرگ فورتنایت با جایزه میلیونی',
            date: '۲۲ مهر ۱۴۰۴',
            content: 'بزرگترین تورنمنت سال فورتنایت به زودی برگزار می‌شود.'
        },
        {
            title: 'گنشین ایمپکت، محبوب‌ترین بازی سال',
            date: '۲۵ مهر ۱۴۰۴',
            content: 'بر اساس آمار جدید، گنشین ایمپکت پرطرفدارترین بازی موبایل در سال جاری است.'
        },
        {
            title: 'براول استارز با کاراکترهای جدید',
            date: '۲ آبان ۱۴۰۴',
            content: 'چند کاراکتر جدید به بازی براول استارز اضافه شدند.'
        },
        {
            title: 'کلش رویال آپدیت جدیدی برای تعادل نیروها منتشر کرد',
            date: '۵ آبان ۱۴۰۴',
            content: 'آپدیت جدید برای ایجاد تعادل در بازی به زودی منتشر می‌شود.'
        },
        {
            title: 'لیگ آف لجندز موبایل، پردرآمدترین بازی ماه',
            date: '۸ آبان ۱۴۰۴',
            content: 'این بازی توانست در ماه اخیر بیشترین درآمد را از آن خود کند.'
        },
        {
            title: 'بازی هی دی به رکورد جدیدی از کاربران فعال رسید',
            date: '۱۱ آبان ۱۴۰۴',
            content: 'هی دی با بیش از ۱۰ میلیون کاربر فعال روزانه، رکورد جدیدی ثبت کرد.'
        },
        {
            title: 'پوکمون گو، همچنان در اوج',
            date: '۱۴ آبان ۱۴۰۴',
            content: 'با وجود سال‌ها از انتشار، پوکمون گو همچنان طرفداران زیادی دارد.'
        },
        {
            title: 'معرفی بازی Plants vs. Zombies 3',
            date: '۱۷ آبان ۱۴۰۴',
            content: 'نسخه سوم بازی محبوب گیاهان در برابر زامبی‌ها به زودی منتشر می‌شود.'
        },
        {
            title: 'نسخه جدید Temple Run با گرافیک واقع‌گرایانه',
            date: '۲۰ آبان ۱۴۰۴',
            content: 'شرکت سازنده اعلام کرد که نسخه جدیدی از تمپل ران با گرافیک فوق‌العاده در راه است.'
        },
        {
            title: 'همکاری Candy Crush با برندهای مشهور',
            date: '۲۳ آبان ۱۴۰۴',
            content: 'کندی کراش با چند برند مواد غذایی معروف همکاری می‌کند.'
        },
        {
            title: 'رونمایی از شخصیت جدید بازی Shadow Fight 4',
            date: '۲۶ آبان ۱۴۰۴',
            content: 'تیزر معرفی شخصیت جدید منتشر شد.'
        },
        {
            title: 'آپدیت بزرگ برای Dream League Soccer',
            date: '۲۹ آبان ۱۴۰۴',
            content: 'آپدیت شامل تیم‌ها و بازیکنان جدید به زودی عرضه می‌شود.'
        },
        {
            title: 'بازی Pou همچنان فعال است!',
            date: '۲ آذر ۱۴۰۴',
            content: 'با وجود قدمت زیاد، بازی پو هنوز میلیون‌ها کاربر دارد.'
        },
        {
            title: 'بازی جدید Need for Speed با خودروهای لوکس',
            date: '۵ آذر ۱۴۰۴',
            content: 'جدیدترین نسخه از سری بازی‌های نید فور اسپید با خودروهای جدید رونمایی شد.'
        },
        {
            title: 'درآمد میلیاردی بازی Pokemon Unite',
            date: '۸ آذر ۱۴۰۴',
            content: 'این بازی از زمان انتشار تا کنون، بیش از یک میلیارد دلار درآمد داشته است.'
        }
        ];

        let users = JSON.parse(localStorage.getItem('users')) || [{
            username: 'admin',
            password: '1234',
            firstName: 'ادمین',
            lastName: '',
            favoriteGames: [],
            role: 'admin',
            status: 'active',
            registrationDate: new Date().toLocaleDateString('fa-IR'),
            lastLogin: new Date().toLocaleString('fa-IR')
        }];
        let loggedInUser = null;
        let comments = JSON.parse(localStorage.getItem('comments')) || [];
        let reports = JSON.parse(localStorage.getItem('reports')) || [];
        let supports = JSON.parse(localStorage.getItem('supports')) || [];
        let messages = JSON.parse(localStorage.getItem('messages')) || [];

        // DOM Elements
        const welcomeSection = document.getElementById('welcome');
        const mainHeader = document.getElementById('main-header');
        const dashboardSections = document.querySelectorAll('.dashboard-content');
        const loginForm = document.getElementById('login-form');
        const registerForm = document.getElementById('register-form');
        const searchInput = document.getElementById('search');
        const filterBtns = document.querySelectorAll('.filter-btn');
        const navMenu = document.querySelector('.nav-menu');
        const userMenu = document.querySelector('.user-menu');
        const userMenuBtn = document.querySelector('.user-menu-btn');
        const notificationBtn = document.querySelector('.notification-btn');
        const notificationPopup = document.querySelector('.notification-popup');
        const themeToggleBtn = document.querySelector('.theme-toggle-btn');
        const hamburgerBtn = document.querySelector('.hamburger');
        const adminPanel = document.getElementById('admin');
        const adminNavMenu = document.querySelector('.admin-nav-menu');
        const adminHamburger = document.querySelector('.admin-hamburger');
        const usernameInput = document.getElementById('register-username');
        const usernameStatus = document.getElementById('username-status');

        document.addEventListener('DOMContentLoaded', () => {
            const adminExists = users.some(user => user.username === 'admin');
            if (!adminExists) {
                users.unshift({
                    username: 'admin',
                    password: '1234',
                    firstName: 'ادمین',
                    lastName: '',
                    favoriteGames: [],
                    role: 'admin',
                    status: 'active',
                    registrationDate: new Date().toLocaleDateString('fa-IR'),
                    lastLogin: new Date().toLocaleString('fa-IR')
                });
                localStorage.setItem('users', JSON.stringify(users));
            }

            populateGameSelects();
            populateNews();
            populateGames();
            checkLoginState();

            hamburgerBtn.addEventListener('click', () => {
                navMenu.classList.toggle('active');
            });

            adminHamburger.addEventListener('click', () => {
                adminNavMenu.classList.toggle('active');
            });

            document.querySelectorAll('.dashboard-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    showSection(btn.dataset.section);
                });
            });

            document.querySelectorAll('.admin-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    showAdminSection(btn.dataset.section);
                });
            });

            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    filterGames();
                });
            });

            document.querySelectorAll('.favorite-filter-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('.favorite-filter-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    renderFavorites();
                });
            });

            searchInput.addEventListener('keyup', filterGames);
            usernameInput.addEventListener('keyup', checkUsernameAvailability);

            userMenuBtn.addEventListener('click', () => {
                userMenu.classList.toggle('active');
            });

            notificationBtn.addEventListener('click', () => {
                notificationPopup.classList.toggle('active');
            });

            themeToggleBtn.addEventListener('click', () => {
                document.body.dataset.theme = document.body.dataset.theme === 'light' ? 'dark' : 'light';
            });
        });

        function populateGameSelects() {
            const select1 = document.getElementById('favorite-game-1');
            const select2 = document.getElementById('favorite-game-2');
            const select3 = document.getElementById('favorite-game-3');
            GAMES.forEach(game => {
                const option = `<option value="${game.id}">${game.name}</option>`;
                select1.innerHTML += option;
                select2.innerHTML += option;
                select3.innerHTML += option;
            });
        }

        function togglePasswordVisibility(id) {
            const passwordInput = document.getElementById(id);
            const toggleButton = passwordInput.nextElementSibling;
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M20 17.15c-1.35-1.76-3.11-3.08-5.18-3.92l-1.39-1.39L14.73 9l.34-.34c-.95-1.12-2.19-2.02-3.64-2.61L9.12 5.59l-.39-.39c-1.28-.48-2.67-.7-4.13-.7-2.64 0-5.18 1.41-7.23 3.82L0 12l.66.86c1.94 2.5 4.54 4.14 7.42 4.75l1.55 1.55L14.41 22l.59-.59c1.07.4 2.22.64 3.42.64 2.5 0 4.88-1.29 6.74-3.5L24 12c-1.92-2.18-4.2-3.8-6.85-4.52l-1.16-1.16L20 17.15zM12 15c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zM12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5z"/>
                </svg>`;
            } else {
                passwordInput.type = 'password';
                toggleButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 4.5C7 4.5 2.73 7.61 0 12c2.73 4.39 7 7.5 12 7.5s9.27-3.11 12-7.5c-2.73-4.39-7-7.5-12-7.5zM12 17.5c-4.41 0-8.24-2.82-10-6.5C3.76 8.32 7.59 5.5 12 5.5s8.24 2.82 10 6.5c-1.76 3.68-5.59 6.5-10 6.5z"/>
                        <circle cx="12" cy="12" r="3"/>
                </svg>`;
            }
        }

        function populateGames() {
            const topGrid = document.getElementById('top-grid');
            const suggestedGrid = document.getElementById('suggested-grid');
            topGrid.innerHTML = '';
            suggestedGrid.innerHTML = '';

            const topGames = GAMES.sort((a, b) => parseFloat(b.downloads) - parseFloat(a.downloads)).slice(0, 5);
            const suggestedGames = GAMES.slice(5);

            topGames.forEach(game => {
                topGrid.innerHTML += createGameCard(game);
            });
            suggestedGames.forEach(game => {
                suggestedGrid.innerHTML += createGameCard(game);
            });
        }

        function populateNews() {
            const newsGrid = document.getElementById('news-grid');
            newsGrid.innerHTML = '';
            NEWS.forEach(newsItem => {
                newsGrid.innerHTML += `
                    <div class="news-card">
                        <h3>${newsItem.title}</h3>
                        <p><strong>${newsItem.date}</strong> - ${newsItem.content}</p>
                    </div>
                `;
            });
        }

        function filterGames() {
            const searchText = searchInput.value.trim().toLowerCase();
            const activeFilterBtn = document.querySelector('.filter-btn.active');
            const filterType = activeFilterBtn?.dataset.filter || 'all';
            const filterGenre = activeFilterBtn?.dataset.genre || 'all';
            const filterRating = activeFilterBtn?.dataset.rating || 'all';

            const filteredGames = GAMES.filter(game => {
                const nameMatch = game.name.toLowerCase().includes(searchText);
                const typeMatch = filterType === 'all' || filterType === game.type;
                const genreMatch = filterGenre === 'all' || filterGenre === game.genre;
                const ratingMatch = filterRating === 'all' || filterRating === game.rating;
                return nameMatch && typeMatch && genreMatch && ratingMatch;
            });

            const topGrid = document.getElementById('top-grid');
            const suggestedGrid = document.getElementById('suggested-grid');

            topGrid.innerHTML = '';
            suggestedGrid.innerHTML = '';

            if (filteredGames.length === 0) {
                topGrid.innerHTML = '<p style="text-align: center;">هیچ بازی با این مشخصات یافت نشد.</p>';
                suggestedGrid.innerHTML = '';
            } else {
                const topGames = filteredGames.sort((a, b) => parseFloat(b.downloads) - parseFloat(a.downloads)).slice(0, 5);
                const suggestedGames = filteredGames.slice(5);

                topGames.forEach(game => {
                    topGrid.innerHTML += createGameCard(game);
                });

                if (suggestedGames.length > 0) {
                    suggestedGrid.innerHTML = `<h2 class="section-title">نتایج جستجو</h2>`;
                    suggestedGames.forEach(game => {
                        suggestedGrid.innerHTML += createGameCard(game);
                    });
                } else {
                    suggestedGrid.innerHTML = '';
                }
            }
        }

        function showLoginForm() {
            loginForm.classList.add('active');
            registerForm.classList.remove('active');
        }

        function showRegisterForm() {
            registerForm.classList.add('active');
            loginForm.classList.remove('active');
            usernameStatus.textContent = '';
        }

        function checkUsernameAvailability() {
            const username = usernameInput.value.trim();
            if (username.length === 0) {
                usernameStatus.textContent = '';
                return;
            }
            const isTaken = users.some(user => user.username === username);
            if (isTaken) {
                usernameStatus.textContent = 'این یوزرنیم قبلاً ثبت شده است.';
                usernameStatus.style.color = 'red';
            } else {
                usernameStatus.textContent = 'این یوزرنیم در دسترس است.';
                usernameStatus.style.color = 'green';
            }
        }

        function checkLoginState() {
            const storedUser = localStorage.getItem('loggedInUser');
            if (storedUser) {
                loggedInUser = JSON.parse(storedUser);
                const userInDb = users.find(u => u.username === loggedInUser.username);
                if (userInDb) {
                    userInDb.lastLogin = new Date().toLocaleString('fa-IR');
                    localStorage.setItem('users', JSON.stringify(users));
                }
                if (loggedInUser.role === 'admin') {
                    showAdminPanel();
                } else {
                    showDashboard();
                }
            }
            checkNewMessages();
        }

        function login() {
            const username = document.getElementById('login-username').value;
            const password = document.getElementById('login-password').value;

            const user = users.find(u => u.username === username);

            if (user) {
                if (user.status === 'banned') {
                    alert('شما توسط ادمین مسدود شده‌اید و امکان ورود ندارید.');
                    return;
                }
                if (user.password === password) {
                    loggedInUser = user;
                    loggedInUser.lastLogin = new Date().toLocaleString('fa-IR');
                    localStorage.setItem('loggedInUser', JSON.stringify(loggedInUser));

                    const userIndex = users.findIndex(u => u.username === username);
                    if (userIndex !== -1) {
                        users[userIndex].lastLogin = loggedInUser.lastLogin;
                        localStorage.setItem('users', JSON.stringify(users));
                    }

                    alert('ورود با موفقیت انجام شد!');
                    if (user.role === 'admin') {
                        showAdminPanel();
                    } else {
                        showDashboard();
                    }
                } else {
                    alert('رمز عبور اشتباه است!');
                }
            } else {
                alert('یوزرنیم یافت نشد.');
            }
        }

        function register() {
            const username = document.getElementById('register-username').value;
            const firstName = document.getElementById('register-first-name').value;
            const lastName = document.getElementById('register-last-name').value;
            const password = document.getElementById('register-password').value;
            const favGame1 = document.getElementById('favorite-game-1').value;
            const favGame2 = document.getElementById('favorite-game-2').value;
            const favGame3 = document.getElementById('favorite-game-3').value;

            if (!username || !firstName || !lastName || !password) {
                alert('لطفاً همه فیلدها را پر کنید.');
                return;
            }

            if (users.some(user => user.username === username)) {
                alert('این یوزرنیم قبلاً ثبت شده است. لطفاً یوزرنیم دیگری انتخاب کنید.');
                return;
            }

            if (password.length < 8) {
                alert('رمز عبور باید حداقل ۸ کاراکتر باشد.');
                return;
            }

            const newUser = {
                username: DOMPurify.sanitize(username),
                firstName: DOMPurify.sanitize(firstName),
                lastName: DOMPurify.sanitize(lastName),
                password,
                favoriteGames: [favGame1, favGame2, favGame3].filter(g => g !== ''),
                role: 'user',
                status: 'active',
                registrationDate: new Date().toLocaleDateString('fa-IR'),
                lastLogin: new Date().toLocaleString('fa-IR')
            };

            users.push(newUser);
            localStorage.setItem('users', JSON.stringify(users));
            alert(`ثبت‌نام با موفقیت انجام شد. یوزرنیم شما: ${username}`);

            loggedInUser = newUser;
            localStorage.setItem('loggedInUser', JSON.stringify(loggedInUser));
            showDashboard();
        }

        function showDashboard() {
            welcomeSection.style.display = 'none';
            mainHeader.style.display = 'block';
            document.getElementById('search').style.display = 'block';
            document.querySelector('.filters').style.display = 'flex';
            document.getElementById('admin').style.display = 'none';
            userMenuBtn.textContent = `${loggedInUser.firstName} ${loggedInUser.lastName}`;
            showSection('home');
            populateGames();
        }

        function showAdminPanel() {
            welcomeSection.style.display = 'none';
            mainHeader.style.display = 'none';
            document.getElementById('search').style.display = 'none';
            document.querySelector('.filters').style.display = 'none';
            adminPanel.style.display = 'block';
            document.querySelector('.admin-btn[data-section="admin-users"]').click();
        }

        function logout() {
            loggedInUser = null;
            localStorage.removeItem('loggedInUser');
            window.location.reload();
        }

        function showSection(sectionId) {
            dashboardSections.forEach(section => section.style.display = 'none');
            document.getElementById(sectionId).style.display = 'block';
            document.querySelectorAll('.dashboard-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.dashboard-btn[data-section="${sectionId}"]`).classList.add('active');
            navMenu.classList.remove('active');
            userMenu.classList.remove('active');

            if (sectionId === 'favorites') {
                renderFavorites();
            } else if (sectionId === 'home') {
                populateGames();
            } else if (sectionId === 'messages') {
                renderMessages();
            } else if (sectionId === 'edit-profile') {
                document.getElementById('profile-username').textContent = loggedInUser.username;
            }
        }

        function showAdminSection(sectionId) {
            document.querySelectorAll('.admin-content').forEach(section => section.style.display = 'none');
            document.getElementById(sectionId).style.display = 'block';
            document.querySelectorAll('.admin-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.admin-btn[data-section="${sectionId}"]`).classList.add('active');
            adminNavMenu.classList.remove('active');

            if (sectionId === 'admin-users') {
                renderAdminUsers();
            } else if (sectionId === 'admin-comments') {
                renderAdminComments();
            } else if (sectionId === 'admin-reports') {
                renderAdminReports();
            } else if (sectionId === 'admin-supports') {
                renderAdminSupports();
            }
        }

        function createGameCard(game) {
            const isFavorite = loggedInUser && loggedInUser.favoriteGames.includes(game.id);
            return `
                <div class="game-card" data-game-id="${game.id}" data-type="${game.type}" data-genre="${game.genre}" data-rating="${game.rating}">
                    <img class="game-logo" src="${game.logo}" alt="لوگو ${game.name}">
                    <h3>${game.name}</h3>
                    <p><strong>نوع:</strong> ${game.type}</p>
                    <p><strong>ژانر:</strong> ${game.genre}</p>
                    <p><strong>رده سنی:</strong> ${game.rating}</p>
                    <p><strong>امتیاز:</strong> ${game.rating}</p>
                    <a href="#" class="download-btn">دانلود</a>
                    <button class="favorite-btn ${isFavorite ? 'active' : ''}" onclick="toggleFavorite('${game.id}')">
                        ${isFavorite ? 'حذف از مورد علاقه' : 'افزودن به مورد علاقه'}
                    </button>
                    <button class="comment-btn" onclick="toggleComments('${game.id}')">نظرات</button>
                    <div class="comment-form" id="comment-form-${game.id}">
                        <input type="text" id="comment-user-${game.id}" placeholder="نام شما" value="${loggedInUser ? loggedInUser.firstName : ''}">
                        <textarea id="comment-text-${game.id}" placeholder="نظر شما"></textarea>
                        <button class="submit-btn" onclick="addComment('${game.id}')">ارسال نظر</button>
                    </div>
                    <div class="comments-list" id="comments-list-${game.id}"></div>
                </div>
            `;
        }

        function toggleFavorite(gameId) {
            if (!loggedInUser) {
                alert('برای افزودن به علاقه‌مندی‌ها ابتدا وارد شوید.');
                return;
            }

            const index = loggedInUser.favoriteGames.indexOf(gameId);
            if (index > -1) {
                loggedInUser.favoriteGames.splice(index, 1);
            } else {
                loggedInUser.favoriteGames.push(gameId);
            }
            localStorage.setItem('loggedInUser', JSON.stringify(loggedInUser));

            const userIndex = users.findIndex(u => u.username === loggedInUser.username);
            if (userIndex !== -1) {
                users[userIndex].favoriteGames = loggedInUser.favoriteGames;
                localStorage.setItem('users', JSON.stringify(users));
            }

            if (document.getElementById('favorites').style.display === 'block') {
                renderFavorites();
            } else if (document.getElementById('home').style.display === 'block') {
                populateGames();
            }
        }

        function renderFavorites() {
            const favoritesGrid = document.getElementById('favorites-grid');
            favoritesGrid.innerHTML = '';
            if (!loggedInUser || loggedInUser.favoriteGames.length === 0) {
                favoritesGrid.innerHTML = '<p style="text-align: center;">شما هیچ بازی در لیست علاقه‌مندی‌ها ندارید.</p>';
                return;
            }

            const activeFilterBtn = document.querySelector('.favorite-filter-btn.active');
            const filterType = activeFilterBtn?.dataset.filter || 'all';
            const filterGenre = activeFilterBtn?.dataset.genre || 'all';
            const filterRating = activeFilterBtn?.dataset.rating || 'all';

            const filteredGames = GAMES.filter(game => {
                const isFavorite = loggedInUser.favoriteGames.includes(game.id);
                const typeMatch = filterType === 'all' || filterType === game.type;
                const genreMatch = filterGenre === 'all' || filterGenre === game.genre;
                const ratingMatch = filterRating === 'all' || filterRating === game.rating;
                return isFavorite && typeMatch && genreMatch && ratingMatch;
            });

            if (filteredGames.length === 0) {
                favoritesGrid.innerHTML = '<p style="text-align: center;">هیچ بازی با این فیلتر در لیست علاقه‌مندی‌های شما یافت نشد.</p>';
            } else {
                filteredGames.forEach(game => {
                    favoritesGrid.innerHTML += createGameCard(game);
                });
            }
        }

        function showFavoriteGames() {
            const favoritesList = document.getElementById('favorites-list');
            favoritesList.innerHTML = '';
            if (!loggedInUser || loggedInUser.favoriteGames.length === 0) {
                favoritesList.innerHTML = '<p>شما هیچ بازی در لیست علاقه‌مندی‌ها ندارید.</p>';
            } else {
                const favoriteGames = GAMES.filter(game => loggedInUser.favoriteGames.includes(game.id));
                favoriteGames.forEach(game => {
                    favoritesList.innerHTML += `<div class="notification-item">${game.name}</div>`;
                });
            }
            document.querySelector('.favorites-popup').classList.add('active');
        }

        function closeFavoritesPopup() {
            document.querySelector('.favorites-popup').classList.remove('active');
        }

        function toggleComments(gameId) {
            const commentForm = document.getElementById(`comment-form-${gameId}`);
            commentForm.style.display = commentForm.style.display === 'flex' ? 'none' : 'flex';
            renderComments(gameId);
        }

        function addComment(gameId) {
            if (!loggedInUser) {
                alert('برای ارسال نظر ابتدا وارد شوید.');
                return;
            }
            const userName = document.getElementById(`comment-user-${gameId}`).value;
            const commentText = document.getElementById(`comment-text-${gameId}`).value;

            if (commentText.trim() === '') {
                alert('لطفاً نظر خود را وارد کنید.');
                return;
            }

            const newComment = {
                gameId,
                username: loggedInUser.username,
                userName: DOMPurify.sanitize(userName),
                comment: DOMPurify.sanitize(commentText)
            };

            comments.push(newComment);
            localStorage.setItem('comments', JSON.stringify(comments));
            document.getElementById(`comment-text-${gameId}`).value = '';
            renderComments(gameId);
        }

        function renderComments(gameId) {
            const commentsList = document.getElementById(`comments-list-${gameId}`);
            commentsList.innerHTML = '';
            const gameComments = comments.filter(c => c.gameId === gameId);
            if (gameComments.length === 0) {
                commentsList.innerHTML = '<p>اولین نفری باشید که نظر می‌دهد.</p>';
            } else {
                gameComments.forEach(comment => {
                    commentsList.innerHTML += `
                        <div class="comment-item">
                            <strong>${comment.userName}:</strong> ${comment.comment}
                        </div>
                    `;
                });
            }
        }

        function submitSupport() {
            const name = document.getElementById('support-name').value;
            const message = document.getElementById('support-message').value;

            if (name.trim() === '' || message.trim() === '') {
                alert('لطفاً همه فیلدها را پر کنید.');
                return;
            }

            const supportRequest = {
                name: DOMPurify.sanitize(name),
                message: DOMPurify.sanitize(message)
            };
            supports.push(supportRequest);
            localStorage.setItem('supports', JSON.stringify(supports));
            alert('درخواست شما با موفقیت ارسال شد!');
            document.getElementById('support-name').value = '';
            document.getElementById('support-message').value = '';
        }

        function submitReport() {
            const name = document.getElementById('report-name').value;
            const message = document.getElementById('report-message').value;

            if (name.trim() === '' || message.trim() === '') {
                alert('لطفاً همه فیلدها را پر کنید.');
                return;
            }

            const reportRequest = {
                name: DOMPurify.sanitize(name),
                message: DOMPurify.sanitize(message)
            };
            reports.push(reportRequest);
            localStorage.setItem('reports', JSON.stringify(reports));
            alert('گزارش شما با موفقیت ارسال شد!');
            document.getElementById('report-name').value = '';
            document.getElementById('report-message').value = '';
        }

        function renderAdminUsers() {
            const usersTableBody = document.querySelector('#users-table tbody');
            usersTableBody.innerHTML = '';
            users.forEach(user => {
                if (user.role === 'admin') return;
                const favGames = user.favoriteGames.map(gameId => GAMES.find(g => g.id === gameId)?.name).join(', ') || 'ندارد';
                const status = user.status === 'banned' ? 'مسدود' : 'فعال';
                const statusBtnText = user.status === 'banned' ? 'رفع مسدودی' : 'مسدود کردن';
                const row = `
                    <tr>
                        <td>${user.username}</td>
                        <td>${user.firstName}</td>
                        <td>${user.lastName}</td>
                        <td>${user.registrationDate || 'نامشخص'}</td>
                        <td>${user.lastLogin || 'نامشخص'}</td>
                        <td>${status}</td>
                        <td>
                            <button onclick="toggleUserStatus('${user.username}')" class="${user.status === 'banned' ? 'unban' : ''}">${statusBtnText}</button>
                            <button class="delete-user" onclick="deleteUser('${user.username}')">حذف</button>
                        </td>
                    </tr>
                `;
                usersTableBody.innerHTML += row;
            });
        }

        function toggleUserStatus(username) {
            const user = users.find(u => u.username === username);
            if (user) {
                user.status = user.status === 'active' ? 'banned' : 'active';
                localStorage.setItem('users', JSON.stringify(users));
                renderAdminUsers();
                alert(`وضعیت کاربر ${username} به ${user.status === 'banned' ? 'مسدود' : 'فعال'} تغییر یافت.`);
            }
        }

        function deleteUser(username) {
            if (confirm(`آیا از حذف کاربر ${username} مطمئن هستید؟ این عمل غیرقابل بازگشت است.`)) {
                users = users.filter(user => user.username !== username);
                localStorage.setItem('users', JSON.stringify(users));
                renderAdminUsers();
                alert(`کاربر ${username} با موفقیت حذف شد.`);
            }
        }

        function renderAdminComments() {
            const commentsTableBody = document.querySelector('#comments-table tbody');
            commentsTableBody.innerHTML = '';
            comments.forEach((comment, index) => {
                const gameName = GAMES.find(g => g.id === comment.gameId)?.name || 'ناشناس';
                const row = `
                    <tr>
                        <td>${gameName}</td>
                        <td>${comment.userName}</td>
                        <td>${comment.comment}</td>
                        <td>
                            <button onclick="deleteComment(${index})">حذف</button>
                        </td>
                    </tr>
                `;
                commentsTableBody.innerHTML += row;
            });
        }

        function deleteComment(index) {
            if (confirm('آیا از حذف این نظر مطمئن هستید؟')) {
                comments.splice(index, 1);
                localStorage.setItem('comments', JSON.stringify(comments));
                renderAdminComments();
                alert('نظر با موفقیت حذف شد.');
            }
        }

        function renderAdminReports() {
            const reportsTableBody = document.querySelector('#reports-table tbody');
            reportsTableBody.innerHTML = '';
            reports.forEach((report, index) => {
                const row = `
                    <tr>
                        <td>${report.name}</td>
                        <td>${report.message}</td>
                        <td>
                            <button onclick="deleteReport(${index})">حذف</button>
                        </td>
                    </tr>
                `;
                reportsTableBody.innerHTML += row;
            });
        }

        function deleteReport(index) {
            if (confirm('آیا از حذف این گزارش مطمئن هستید؟')) {
                reports.splice(index, 1);
                localStorage.setItem('reports', JSON.stringify(reports));
                renderAdminReports();
                alert('گزارش با موفقیت حذف شد.');
            }
        }

        function renderAdminSupports() {
            const supportsTableBody = document.querySelector('#supports-table tbody');
            supportsTableBody.innerHTML = '';
            supports.forEach((support, index) => {
                const row = `
                    <tr>
                        <td>${support.name}</td>
                        <td>${support.message}</td>
                        <td>
                            <button onclick="deleteSupport(${index})">حذف</button>
                        </td>
                    </tr>
                `;
                supportsTableBody.innerHTML += row;
            });
        }

        function deleteSupport(index) {
            if (confirm('آیا از حذف این درخواست پشتیبانی مطمئن هستید؟')) {
                supports.splice(index, 1);
                localStorage.setItem('supports', JSON.stringify(supports));
                renderAdminSupports();
                alert('درخواست پشتیبانی با موفقیت حذف شد.');
            }
        }

        function showEditProfile() {
            showSection('edit-profile');
            document.getElementById('edit-first-name').value = loggedInUser.firstName;
            document.getElementById('edit-last-name').value = loggedInUser.lastName;
            document.getElementById('edit-password').value = '';
            document.getElementById('profile-username').textContent = loggedInUser.username;
        }

        function saveProfileChanges() {
            const newFirstName = document.getElementById('edit-first-name').value;
            const newLastName = document.getElementById('edit-last-name').value;
            const newPassword = document.getElementById('edit-password').value;

            if (newPassword.length > 0 && newPassword.length < 8) {
                alert('رمز عبور باید حداقل ۸ کاراکتر باشد.');
                return;
            }

            loggedInUser.firstName = DOMPurify.sanitize(newFirstName);
            loggedInUser.lastName = DOMPurify.sanitize(newLastName);
            if (newPassword.length > 0) {
                loggedInUser.password = newPassword;
            }

            const userIndex = users.findIndex(u => u.username === loggedInUser.username);
            if (userIndex !== -1) {
                users[userIndex] = {
                    ...loggedInUser
                };
                localStorage.setItem('users', JSON.stringify(users));
                localStorage.setItem('loggedInUser', JSON.stringify(loggedInUser));
            }

            alert('اطلاعات پروفایل شما با موفقیت به‌روزرسانی شد.');
            showSection('home');
            userMenuBtn.textContent = `${loggedInUser.firstName} ${loggedInUser.lastName}`;
        }

        function renderMessages() {
            const inboxList = document.getElementById('inbox-list');
            const outboxList = document.getElementById('outbox-list');
            inboxList.innerHTML = '';
            outboxList.innerHTML = '';
            document.querySelector('.new-message-form').style.display = 'none';

            const receivedMessages = messages.filter(msg => msg.receiverId === loggedInUser.username);
            const sentMessages = messages.filter(msg => msg.senderId === loggedInUser.username);

            if (receivedMessages.length === 0) {
                inboxList.innerHTML = '<p>صندوق ورودی شما خالی است.</p>';
            } else {
                receivedMessages.forEach(msg => {
                    inboxList.innerHTML += `
                        <div class="chat-message received" onclick="replyToMessage('${msg.senderId}')">
                            <strong>فرستنده: ${msg.senderId}</strong>
                            <p>${msg.text}</p>
                            <small>${msg.date}</small>
                        </div>
                    `;
                });
            }

            if (sentMessages.length === 0) {
                outboxList.innerHTML = '<p>شما هیچ پیامی ارسال نکرده‌اید.</p>';
            } else {
                sentMessages.forEach(msg => {
                    outboxList.innerHTML += `
                        <div class="chat-message sent">
                            <strong>گیرنده: ${msg.receiverId}</strong>
                            <p>${msg.text}</p>
                            <small>${msg.date}</small>
                        </div>
                    `;
                });
            }
        }

        function showSendMessageForm() {
            document.querySelector('.new-message-form').style.display = 'flex';
            document.getElementById('message-recipient').value = '';
            document.getElementById('message-text').value = '';
        }

        function replyToMessage(recipientUsername) {
            showSendMessageForm();
            document.getElementById('message-recipient').value = recipientUsername;
            document.getElementById('message-text').focus();
        }

        function sendMessage() {
            const recipientUsername = document.getElementById('message-recipient').value;
            const messageText = document.getElementById('message-text').value;

            const recipient = users.find(u => u.username === recipientUsername);

            if (!recipient) {
                alert('یوزرنیم گیرنده یافت نشد.');
                return;
            }

            if (messageText.trim() === '') {
                alert('لطفاً متن پیام را وارد کنید.');
                return;
            }

            const newMessage = {
                senderId: loggedInUser.username,
                receiverId: DOMPurify.sanitize(recipientUsername),
                text: DOMPurify.sanitize(messageText),
                date: new Date().toLocaleString('fa-IR')
            };

            messages.push(newMessage);
            localStorage.setItem('messages', JSON.stringify(messages));
            alert('پیام شما با موفقیت ارسال شد!');

            document.getElementById('message-recipient').value = '';
            document.getElementById('message-text').value = '';
            document.querySelector('.new-message-form').style.display = 'none';
            renderMessages();
        }

        function showNewMessageNotification(senderUsername) {
            const senderUser = users.find(u => u.username === senderUsername);
            const notificationText = `«${senderUser.firstName}» به شما پیام داد!`;
            const notificationDiv = document.createElement('div');
            notificationDiv.className = 'new-message-notification';
            notificationDiv.textContent = notificationText;
            document.body.appendChild(notificationDiv);
            setTimeout(() => {
                notificationDiv.remove();
            }, 4000);
        }

        let newMessagesCheckInterval;
        let lastMessageCount = 0;
        function checkNewMessages() {
            if (loggedInUser && loggedInUser.role !== 'admin') {
                if (!newMessagesCheckInterval) {
                    newMessagesCheckInterval = setInterval(() => {
                        const currentMessages = JSON.parse(localStorage.getItem('messages')) || [];
                        const receivedMessages = currentMessages.filter(msg => msg.receiverId === loggedInUser.username);
                        if (receivedMessages.length > lastMessageCount) {
                            showNewMessageNotification(receivedMessages[receivedMessages.length - 1].senderId);
                            lastMessageCount = receivedMessages.length;
                        } else {
                            lastMessageCount = receivedMessages.length;
                        }
                    }, 5000);
                }
            } else {
                clearInterval(newMessagesCheckInterval);
                newMessagesCheckInterval = null;
            }
        }
    </script>
</body>

</html>